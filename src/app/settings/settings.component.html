<div class="container">
  <form class="row" [formGroup]="inkPriceForm">
    <div class="col-6">
      <div class="card mt-5 mb-5">
        <div class="card-header d-flex flex-row">
          <div class="card-header-text">Encres</div>
        </div>
        <div class="card-body">
          <div class="flex-form w-100">
            <div class="form-cell-settings w-100">
              <label for="panelInkPrice">Panneau</label>
              <div class="euro-input position-relative">
                <input
                  type="number"
                  formControlName="panelInkPrice"
                  id="panelInkPrice"
                />
                <span class="euro"></span>
              </div>
            </div>
            <div class="form-cell-settings w-100">
              <label for="rollInkPrice">Rouleau</label>
              <div class="euro-input position-relative">
                <input
                  type="number"
                  formControlName="rollInkPrice"
                  id="rollInkPrice"
                />
                <span class="euro"></span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-6">
      <div class="card mt-5 mb-5">
        <div class="card-header d-flex flex-row">
          <div class="card-header-text">Options</div>
        </div>
        <div class="card-body">
          <form [formGroup]="optionSettingsForm">
            <div class="flex-form w-100">
              <div class="row">
                <div class="col-6 option-inputs">
                  <label for="shinyLaminatePrice">Laminat brillant</label>
                  <div class="euro-input position-relative">
                    <input
                      type="number"
                      id="shinyLaminatePrice"
                      formControlName="shinyLaminatePrice"
                    />
                    <span class="euro"></span>
                  </div>
                </div>
                <div class="col-6 option-inputs">
                  <label for="matteLaminatePrice">Laminat mat</label>
                  <div class="euro-input position-relative">
                    <input
                      type="number"
                      id="matteLaminatePrice"
                      formControlName="matteLaminatePrice"
                    />
                    <span class="euro"></span>
                  </div>
                </div>
                <div class="col-6 option-inputs">
                  <label for="grommetsPrice">Oeillets</label>
                  <div class="euro-input position-relative">
                    <input
                      type="number"
                      id="grommetsPrice"
                      formControlName="grommetsPrice"
                    />
                    <span class="euro"></span>
                  </div>
                </div>
                <div class="col-6 option-inputs">
                  <label for="reinforcementsPrice">Renforts</label>
                  <div class="euro-input position-relative">
                    <input
                      type="number"
                      id="reinforcementsPrice"
                      formControlName="reinforcementsPrice"
                    />
                    <span class="euro"></span>
                  </div>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </form>

  <form [formGroup]="supportSettingsForm">
    <div formArrayName="supportSpec" class="row">
      <div
        *ngFor="let support of getSupportOfProducts().controls; let i = index"
        class="col-6"
      >
        <div class="card mb-4" [formGroupName]="i">
          <div
            class="card-header d-flex flex-row justify-content-between align-items-center"
          >
            <div class="card-header-text w-25">
              <input
                class="w-100"
                type="text"
                id="productName-{{ i }}"
                formControlName="supportName"
              />
            </div>

            <div class="card-header-selection">
              <select
                name="support"
                id="productSupport-{{ i }}"
                formControlName="supportType"
                (change)="onAddSupportFormat(i)"
              >
                <option disabled selected value=""></option>
                <option value="panel">panneau</option>
                <option value="roll">Rouleau</option>
              </select>
              <input
                type="number"
                class="price-box"
                id="productPrice-{{ i }}"
                formControlName="supportPrice"
              />
            </div>
          </div>
          <div class="card-body">
            <table
              *ngIf="
                getSupportOfProducts().controls[i].get('supportType')?.value ===
                  'panel' ||
                getSupportOfProducts().controls[i].get('supportType')?.value ===
                  'roll'
              "
              class="product-listings w-100"
              formArrayName="supportFormat"
            >
              <thead>
                <tr>
                  <th>Longueur</th>
                  <th
                    *ngIf="
                      getSupportOfProducts().controls[i].get('supportType')
                        ?.value === 'panel'
                    "
                  >
                    Largeur
                  </th>
                  <th>Actif</th>
                  <th></th>
                  <th
                    *ngIf="
                      getSupportOfProducts().controls[i].get('supportType')
                        ?.value === 'roll'
                    "
                  >
                    Options
                  </th>
                </tr>
              </thead>
              <tbody
                *ngFor="
                  let format of getSupportFormatOfProducts(i).controls;
                  let j = index
                "
              >
                <tr formGroupName="{{ j }}">
                  <td>
                    <input
                      id="length-{{ j }}"
                      formControlName="length"
                      type="number"
                    />
                  </td>
                  <td
                    *ngIf="
                      getSupportOfProducts().controls[i].get('supportType')
                        ?.value === 'panel'
                    "
                  >
                    <input
                      type="number"
                      id="width-{{ j }}"
                      formControlName="width"
                    />
                  </td>
                  <td>
                    <input
                      id="active-{{ j }}"
                      formControlName="active"
                      type="checkbox"
                    />
                  </td>
                  <td>
                    <svg-icon
                      src="../../assets/icons/trash.svg"
                      class="mr-2"
                      (click)="removeSupportFormat(i, j)"
                    ></svg-icon>
                  </td>
                  <td
                    *ngIf="
                      getSupportOfProducts().controls[i].get('supportType')
                        ?.value === 'roll'
                    "
                  >
                    <div class="support-options">
                      <div class="options">
                        <div class="option-item">
                          <input
                            type="checkbox"
                            id="shinyLaminate-{{ j }}"
                            formControlName="shinyLaminate"
                          />
                          <label for="shinyLaminate-{{ j }}"
                            >Laminat brillant</label
                          >
                        </div>
                        <div class="option-item">
                          <input
                            type="checkbox"
                            id="matteLaminate-{{ j }}"
                            formControlName="matteLaminate"
                          />
                          <label for="matteLaminate-{{ j }}">Laminat mat</label>
                        </div>
                        <div class="option-item">
                          <input
                            type="checkbox"
                            id="grommets-{{ j }}"
                            formControlName="grommets"
                          />
                          <label for="grommets-{{ j }}">Oeillet</label>
                        </div>
                        <div class="option-item">
                          <input
                            type="checkbox"
                            id="reinforcements-{{ j }}"
                            formControlName="reinforcements"
                          />
                          <label for="reinforcements-{{ j }}">renfort</label>
                        </div>
                      </div>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <div
            class="card-body d-flex flex-row justify-content-between"
            *ngIf="
              getSupportOfProducts().controls[i].get('supportType')?.value ===
              'roll'
            "
          ></div>
          <button
            class="btn btn-primary w-25 my-3 mx-3"
            (click)="onAddSupportFormat(i)"
            [disabled]="
              getSupportOfProducts().controls[i].get('supportType')?.value ===
              ''
            "
          >
            <svg-icon src="../../assets/icons/plus.svg" class="mr-2"></svg-icon>
            formats
          </button>
        </div>
      </div>
    </div>
  </form>

  <div class="d-flex flex-row w-100 justify-content-center">
    <button class="btn btn-primary mx-1" (click)="onAddSupport()">
      <svg-icon src="../../assets/icons/plus.svg" class="mr-2"></svg-icon>
      support
    </button>
    <button class="btn btn-primary mx-1" (click)="onSubmit()">
      <svg-icon src="../../assets/icons/document.svg" class="mr-2"></svg-icon>
      sauvegarder
    </button>
  </div>
</div>
